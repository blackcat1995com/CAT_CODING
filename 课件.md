## 界面绘制

![img](https://p3-sign.toutiaoimg.com/tos-cn-i-qvj2lq49k0/fe33e6f37c004dae886fa541e7e37b39~tplv-obj.jpg?traceid=20230227170609A229FB656ECE1A3C7474&x-expires=2147483647&x-signature=LS%2BiPIDYYir6IrQWJTJP4NKP1Ds%3D)

编辑框ID：`IDC_EDIT_A、IDC_EDIT_B、IDC_EDIT_C`

加法按钮ID：`IDC_BUTTON_ADD1~7`

## 方法1：GetDlgItem()->GetWindowTextW()

```cpp
const int N = 20;
void CDemoDlg::OnBnClickedButtonAdd1()
{
	TCHAR str1[N], str2[N], str3[N];

	GetDlgItem(IDC_EDIT_A)->GetWindowTextW(str1, N);
	GetDlgItem(IDC_EDIT_B)->GetWindowTextW(str2, N);

	int a = _ttoi(str1);
	int b = _ttoi(str2);

	int c = a + b;

	_itow_s(c, str3, 10);

	GetDlgItem(IDC_EDIT_C)->SetWindowTextW(str3);
}
```

## 方法2：GetDlgItemText()

```cpp
void CDemoDlg::OnBnClickedButtonAdd2()
{
	TCHAR str1[N], str2[N], str3[N];

	GetDlgItemText(IDC_EDIT_A, str1, N);
	GetDlgItemText(IDC_EDIT_B, str2, N);

	int a = _ttoi(str1);
	int b = _ttoi(str2);

	int c = a + b;

	_itow_s(c, str3, 10);

	SetDlgItemText(IDC_EDIT_C, str3);
}
```

TCHAR转CString：

```cpp
TCHAR chs[N] = _T("Hello");
CString str;
str.Format(_T("%s"), chs);
OutputDebugString(str);
```

TCHAR*转CString：

```cpp
CString str1, str2;
GetDlgItemText(IDC_EDIT_A, str1);
GetDlgItemText(IDC_EDIT_B, str2);

TCHAR* chs1 = new TCHAR[N];
TCHAR* chs2 = new TCHAR[N];
TCHAR chs3[N];

chs1 = str1.GetBuffer(str1.GetLength());
chs2 = str2.GetBuffer(str2.GetLength());

int a = _ttoi(chs1);
int b = _ttoi(chs2);

int c = a + b;

_itow_s(c, chs3, 10);

SetDlgItemText(IDC_EDIT_C, chs3);

str1.ReleaseBuffer(); 
str2.ReleaseBuffer();
```

## 方法3：GetDlgItemInt()

```cpp
int a = GetDlgItemInt(IDC_EDIT_A);
int b = GetDlgItemInt(IDC_EDIT_B);

int c = a + b;

SetDlgItemInt(IDC_EDIT_C, c);
```

## 方法4：关联数值类型变量

**MFC框架为用户提供了在对话框控件和数据变量间交换数据的DDX/DDV（数据交换/数据验证）机制。**

DDX将数据成员变量和控件相连接，使得数据访问更加方便。

DDV用于数据校验，例如校验成员变量数值范围，并发出相应的警告。

![img](https://p3-sign.toutiaoimg.com/tos-cn-i-qvj2lq49k0/7f9f4c64e01e43ddad3bb1ac0f585932~tplv-obj.jpg?traceid=20230227170609A229FB656ECE1A3C7474&x-expires=2147483647&x-signature=ihz6x7CcVAqyaTQxly70oR07FFA%3D)

**UpdateData()函数接收一个BOOL类型参数，TRUE表示将控件中的数据传输到变量中，FALSE表示将变量中的数据传输到控件上。**

UpdateData()并不直接完成DDX/DDV机制相关操作，而是通过调用一个DoDataExchange函数实现。

给编辑框IDC_EDIT_A关联值类型变量：选中编辑框-鼠标右键-添加变量

![img](https://p3-sign.toutiaoimg.com/tos-cn-i-qvj2lq49k0/8ae973addbb441a0968ea88db5a9afaa~tplv-obj.jpg?traceid=20230227170609A229FB656ECE1A3C7474&x-expires=2147483647&x-signature=ndCQhmIzphC%2FjDIU4NKO4wwraak%3D)

Dlg.h：

![img](https://p3-sign.toutiaoimg.com/tos-cn-i-qvj2lq49k0/02fbecdd1f0546b298c7aea5e618f2ce~tplv-obj.jpg?traceid=20230227170609A229FB656ECE1A3C7474&x-expires=2147483647&x-signature=ajrVQhEsYUvsgx0u2kMgvKvkZR4%3D)

Dlg.cpp：

![img](https://p3-sign.toutiaoimg.com/tos-cn-i-qvj2lq49k0/e99c0f8234fa4df8a7d945f4bccc2f19~tplv-obj.jpg?traceid=20230227170609A229FB656ECE1A3C7474&x-expires=2147483647&x-signature=UEVcbQwgcvuZki4oi%2FXY7wi4%2FAI%3D)

默认初始值为0。

设置数值范围：

![img](https://p3-sign.toutiaoimg.com/tos-cn-i-qvj2lq49k0/f2ec9c44915e4e799f5782bf6b883944~tplv-obj.jpg?traceid=20230227170609A229FB656ECE1A3C7474&x-expires=2147483647&x-signature=hN2KYn%2BP%2BhgOwH%2Fyximvw7BVrKE%3D)

同理，给另外两个编辑框关联int类型变量。

```cpp
UpdateData(TRUE);
m_edit_c_value = m_edit_a_value + m_edit_b_value;
UpdateData(FALSE);
```

![img](https://p3-sign.toutiaoimg.com/tos-cn-i-qvj2lq49k0/be4da0c1e7bb47ad961c1f98f53ebd45~tplv-obj.jpg?traceid=20230227170609A229FB656ECE1A3C7474&x-expires=2147483647&x-signature=nInAnyzvVm3DQs2EcNFpXpacX30%3D)

## 方法5：关联控件类型变量

![img](https://p3-sign.toutiaoimg.com/tos-cn-i-qvj2lq49k0/0b8d0a454b254ec0853f328b6f1102f7~tplv-obj.jpg?traceid=20230227170609A229FB656ECE1A3C7474&x-expires=2147483647&x-signature=WMd9cpXR%2FUaZxheL9ca7Kt5Je0s%3D)

```cpp
void CDemoDlg::OnBnClickedButtonAdd5()
{
	CString str1, str2;
	m_edit_a_control.GetWindowTextW(str1);
	m_edit_b_control.GetWindowTextW(str2);

	// OutputDebugString(str1 + str2);

	// Cstring 转 int
	int a = _ttoi(str1);
	int b = _ttoi(str2);

	int c = a + b;

	// int 转 CString
	CString str3;
	str3.Format(_T("%d"), c);
	m_edit_c_control.SetWindowTextW(str3);
}
```

## 方法6：SendMessage()

```cpp
void CDemoDlg::OnBnClickedButtonAdd6()
{
	TCHAR chs1[N], chs2[N], chs3[N];

	::SendMessage(GetDlgItem(IDC_EDIT_A)->m_hWnd, WM_GETTEXT, N, (LPARAM)chs1);
	::SendMessage(GetDlgItem(IDC_EDIT_B)->m_hWnd, WM_GETTEXT, N, (LPARAM)chs2);

	int a = _ttoi(chs1);
	int b = _ttoi(chs2);

	int c = a + b;

	_itow_s(c, chs3, 10);

	::SendMessage(GetDlgItem(IDC_EDIT_C)->m_hWnd, WM_SETTEXT, 0, (LPARAM)chs3);
}
```

## 方法7：SendDlgItemMessage()

```cpp
void CDemoDlg::OnBnClickedButton7()
{
	TCHAR chs1[N], chs2[N], chs3[N];

	SendDlgItemMessage(IDC_EDIT_A, WM_GETTEXT, N, (LPARAM)chs1);
	SendDlgItemMessage(IDC_EDIT_B, WM_GETTEXT, N, (LPARAM)chs2);

	int a = _ttoi(chs1);
	int b = _ttoi(chs2);

	int c = a + b;

	_itow_s(c, chs3, 10);

	SendDlgItemMessage(IDC_EDIT_C, WM_SETTEXT, 0, (LPARAM)chs3);
}
```

 